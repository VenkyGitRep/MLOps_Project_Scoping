# check function for datetime dimension table
checks for dim_datetime:
  # Check fails when the columns have missing value, OR the data type is different from what we defined
  - schema:
      fail:
        when required column missing: [datetime_id, datetime]
        when wrong column type:
          datetime_id: string
          datetime: datetime
  # Check failes when there are outliers or irrational numbers
  - invalid_count(weekday) = 0:
      name: All weekdays are in range 0-6
      valid min: 0
      valid max: 6
  # Check fails when customer_id is not unique
  - duplicate_count(datetime_id) = 0:
      name: All datetimes are unique
  # Check fails when there's any NULL value
  - missing_count(datetime_id) = 0:
      name: All datetimes have a key
